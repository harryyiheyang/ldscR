% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ldsc.bicov.R
\name{ldsc.bicov}
\alias{ldsc.bicov}
\title{Bivariate LD Score Regression (LDSC) for Cross‑Trait Genetic Covariance}
\usage{
ldsc.bicov(gwas1, gwas2, h21, h22, LDSC, sampling.time = 0, nblock = 500)
}
\arguments{
\item{gwas1}{A `data.frame`/`data.table` of GWAS summary statistics for trait 1.
Required columns:
\itemize{
  \item `SNP` — SNP identifier
  \item `Zscore` — Z‑score of the SNP–trait association
  \item `N` — per‑SNP sample size
}}

\item{gwas2}{A `data.frame`/`data.table` of GWAS summary statistics for trait 2,
with the same required columns as `gwas1`.}

\item{h21}{Numeric. Heritability estimate of trait 1 (used in weights).}

\item{h22}{Numeric. Heritability estimate of trait 2 (used in weights).}

\item{LDSC}{A `data.frame`/`data.table` containing LD scores. Required columns:
\itemize{
  \item `SNP` — SNP identifier
  \item `LDSC` — LD score
}}

\item{sampling.time}{Integer. Number of bootstrap replicates. If `0`, only
point estimates are returned.}

\item{nblock}{Integer. Number of blocks for block bootstrap.}
}
\value{
A `data.frame` with:
\itemize{
  \item `ecov` — estimated intercept (environmental covariance)
  \item `ecov.se` — standard error of `ecov` (bootstrap; `NA` if no bootstrap)
  \item `gcov` — estimated genetic covariance (slope)
  \item `gcov.se` — standard error of `gcov` (bootstrap; `NA` if no bootstrap)
  \item `M` — number of SNPs analyzed
}
}
\description{
`ldsc.bicov` estimates the genetic covariance between two traits using
LD Score Regression (LDSC). The function harmonizes two GWAS
summary-statistic tables with an LD‑score table, fits a weighted least
squares (WLS) regression of \eqn{z_{1j} z_{2j}} on the LD regressor, and
performs one (optional) reweighting step for efficiency. Block bootstrap
can be used to obtain standard errors.
}
\details{
Let \eqn{M} be the number of SNPs after harmonization. The regressor is
\eqn{\ell_j = \mathrm{LDSC}_j \sqrt{N_{1j}} \sqrt{N_{2j}} / M}. The initial
WLS uses weights
\deqn{w_j^{-1} = \bigl(1 + \mathrm{LDSC}_j N_{1j} h_{21} / M \bigr)
                    \bigl(1 + \mathrm{LDSC}_j N_{2j} h_{22} / M \bigr),}
followed by an efficiency reweighting with the mean term
\eqn{\mu_j = \mathrm{ecov} + \mathrm{gcov} \cdot \ell_j} via
\eqn{w_j^{-1} \leftarrow w_j^{-1} + 2 \mu_j^2}.
}
