% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ldsc.univ.R
\name{ldsc.univ}
\alias{ldsc.univ}
\title{Univariate LD Score Regression (LDSC) for SNP-Heritability}
\usage{
ldsc.univ(gwas, LDSC, nblock = 500, sampling.time = 500)
}
\arguments{
\item{gwas}{A `data.frame` or `data.table` of GWAS summary statistics for one trait.
Required columns:
\itemize{
  \item `SNP` — SNP identifier
  \item `Zscore` — Z-score of the SNP–trait association
  \item `N` — per-SNP sample size
  \item `A1` — effect allele
  \item `A2` — reference allele
}
Only `SNP`, `Zscore`, and `N` are used in the computation; alleles are kept
for consistency checks and downstream use.}

\item{LDSC}{A `data.frame` or `data.table` containing LD scores.
Required columns:
\itemize{
  \item `SNP` — SNP identifier
  \item `LDSC` — LD score
}}

\item{nblock}{Integer. Number of blocks for block bootstrap.}

\item{sampling.time}{Integer. Number of bootstrap replicates. If `0`, only
point estimates are returned.}
}
\value{
A `data.frame` with:
\itemize{
  \item `intercept` — estimated LDSC intercept
  \item `intercept.se` — standard error of `intercept` (bootstrap; `NA` if no bootstrap)
  \item `h2` — estimated SNP-heritability (slope)
  \item `h2.se` — standard error of `h2` (bootstrap; `NA` if no bootstrap)
  \item `M` — number of SNPs analyzed
}
}
\description{
`ldsc.univ` estimates SNP-heritability for a single trait using
Linkage Disequilibrium Score Regression (LDSC). The function harmonizes the
GWAS summary statistics with an LD-score table, fits a weighted least squares
(WLS) regression of \eqn{Z_j^2} on the LD regressor, and performs an optional
block bootstrap for standard errors.
}
\details{
Let \eqn{M} be the number of SNPs after harmonization. The regressor is
\eqn{\ell_j = \mathrm{LDSC}_j \, N_j / M}, and we regress \eqn{Z_j^2} on
\eqn{(1, \ell_j)} with WLS. Initial weights use a small ridge factor
\eqn{(1 + 0.1 \, \ell_j)^{-2}}, followed by an efficiency reweighting that
plugs in the estimated heritability \eqn{\hat h^2}:
\eqn{w_j = (1 + \ell_j \, \hat h^2)^{-2}}.
}
